‚ùå Deployment failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
Traceback (most recent call last):
  File "/mnt/c/GitHub/rl-durotaxis/deploy.py", line 492, in main
    results = deployment.run_evaluation(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/GitHub/rl-durotaxis/deploy.py", line 349, in run_evaluation
    stats = self.run_episode(
            ^^^^^^^^^^^^^^^^^
  File "/mnt/c/GitHub/rl-durotaxis/deploy.py", line 208, in run_episode
    output = self.network(state_dict, deterministic=deterministic, action_mask=action_mask)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/GitHub/rl-durotaxis/actor_critic.py", line 462, in forward
    encoder_out = self.encoder(
                  ^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/GitHub/rl-durotaxis/encoder.py", line 285, in forward
    out = self.gnn(x, edge_index, edge_emb, batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/GitHub/rl-durotaxis/encoder.py", line 371, in forward
    x = conv(x, edge_index, edge_attr)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch_geometric/nn/conv/transformer_conv.py", line 229, in forward
    out = self.propagate(edge_index, query=query, key=key, value=value,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/torch_geometric.nn.conv.transformer_conv_TransformerConv_propagate_5fht4uav.py", line 201, in propagate
    kwargs = self.collect(
             ^^^^^^^^^^^^^
  File "/tmp/torch_geometric.nn.conv.transformer_conv_TransformerConv_propagate_5fht4uav.py", line 102, in collect
    query_i = self._index_select(query, edge_index_i)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch_geometric/nn/conv/message_passing.py", line 267, in _index_select
    return self._index_select_safe(src, index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch_geometric/nn/conv/message_passing.py", line 290, in _index_select_safe
    raise e
  File "/home/arlyan/miniconda3/envs/durotaxis/lib/python3.12/site-packages/torch_geometric/nn/conv/message_passing.py", line 271, in _index_select_safe
    return src.index_select(self.node_dim, index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)